<!DOCTYPE html>
<html lang="fa" dir="rtl" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OMID - ูุฑูุฏ / ุซุจุชโูุงู</title>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500&family=Vazirmatn:wght@300;400;700&display=swap" rel="stylesheet"/>

  <link rel="stylesheet" href="styles.css"/>
</head>
<body class="auth-page">
  <!-- ูพุณโุฒููู ูุฏุฑ (ุฏุฑ ุงู ุตูุญู ูุฎู ูโุดูุฏ) -->
  <div id="header-background" class="header-background"></div>

  <!-- ูุฏุฑ ูููุงู ุตูุญู ุงุญุฑุงุฒ ููุช -->
  <header id="main-header" class="main-header active auth-header">
    <div class="header-container">
      <a class="back-link" href="index.html" aria-label="ุจุงุฒฺฏุดุช ุจู ุตูุญู ุงุตู">
        <svg class="icon-outline" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        ุจุงุฒฺฏุดุช
      </a>

      <h1 class="logo">OMID</h1>

      <button id="theme-toggle" class="theme-toggle" aria-label="ุชุบุฑ ุชู">
        <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <img class="icon-moon" src="images/moon-icon.png" alt="Dark Mode Icon"/>
      </button>
    </div>
  </header>

  <div id="page-content" class="page-content">
    <main>
      <div class="auth-container">
        <div class="auth-card">
          <!-- ุชุจโูุง -->
          <div class="auth-tabs" role="tablist">
            <button class="auth-tab active" data-target="#login" role="tab" aria-selected="true">ูุฑูุฏ</button>
            <button class="auth-tab" data-target="#signup" role="tab" aria-selected="false">ุซุจุช ูุงู</button>
          </div>

          <div class="auth-panels">
            <!-- ูุฑู ูุฑูุฏ -->
            <form id="login" class="auth-form active" novalidate>
              <div class="input-group">
                <label for="login-email">ุงูู</label>
                <input id="login-email" type="email" name="email" placeholder="you@example.com" required/>
                <span class="field-error" aria-live="polite"></span>
              </div>

              <div class="input-group password-group">
                <label for="login-password">ุฑูุฒ ุนุจูุฑ</label>
                <input id="login-password" type="password" name="password" placeholder="โขโขโขโขโขโขโขโข" required/>
                <button type="button" class="toggle-password" aria-label="ููุงุด/ูุฎู ฺฉุฑุฏู ุฑูุฒ">๐</button>
                <span class="field-error" aria-live="polite"></span>
              </div>

              <div class="form-row">
                <label class="checkbox">
                  <input type="checkbox" name="remember"/>
                  ูุฑุง ุจู ุฎุงุทุฑ ุจุณูพุงุฑ
                </label>
                <a href="#" class="link" id="forgot-link">ูุฑุงููุด ุฑูุฒุ</a>
              </div>

              <button type="submit" class="btn primary">ูุฑูุฏ</button>

              <div class="or-separator"><span>ุง</span></div>

              <div class="social-row">
                <button type="button" class="btn outline w-100">ูุฑูุฏ ุจุง ฺฏูฺฏู</button>
              </div>

              <div class="form-message" aria-live="polite"></div>
            </form>

            <!-- ูุฑู ุซุจุช ูุงู -->
            <form id="signup" class="auth-form" novalidate>
              <div class="input-group">
                <label for="signup-name">ูุงู ู ูุงู ุฎุงููุงุฏฺฏ</label>
                <input id="signup-name" type="text" name="name" placeholder="ูุงู ฺฉุงูู" required/>
                <span class="field-error" aria-live="polite"></span>
              </div>

              <div class="input-group">
                <label for="signup-email">ุงูู</label>
                <input id="signup-email" type="email" name="email" placeholder="you@example.com" required/>
                <span class="field-error" aria-live="polite"></span>
              </div>

              <div class="input-group">
                <label for="signup-phone">ุดูุงุฑู ููุจุงู (ุงุฎุชุงุฑ)</label>
                <input id="signup-phone" type="tel" name="phone" placeholder="09xxxxxxxxx" pattern="^09\\d{9}$"/>
                <span class="field-error" aria-live="polite"></span>
              </div>

              <div class="input-group password-group">
                <label for="signup-password">ุฑูุฒ ุนุจูุฑ</label>
                <input id="signup-password" type="password" name="password" placeholder="ุญุฏุงูู ธ ฺฉุงุฑุงฺฉุชุฑ" minlength="8" required/>
                <button type="button" class="toggle-password" aria-label="ููุงุด/ูุฎู ฺฉุฑุฏู ุฑูุฒ">๐</button>

                <div class="password-strength" aria-hidden="true">
                  <div class="bar"></div>
                </div>
                <small class="hint">ุญุฏุงูู ธ ฺฉุงุฑุงฺฉุชุฑ ุดุงูู ุญุฑู ู ุนุฏุฏ</small>
                <span class="field-error" aria-live="polite"></span>
              </div>

              <div class="input-group">
                <label for="signup-confirm">ุชฺฉุฑุงุฑ ุฑูุฒ ุนุจูุฑ</label>
                <input id="signup-confirm" type="password" name="confirm" placeholder="ุชฺฉุฑุงุฑ ุฑูุฒ" required/>
                <span class="field-error" aria-live="polite"></span>
              </div>

              <label class="checkbox">
                <input type="checkbox" name="terms" required/>
                ุดุฑุงุท ู ููุงูู ุฑุง ูโูพุฐุฑู
              </label>

              <button type="submit" class="btn primary">ุซุจุช ูุงู</button>

              <div class="form-message" aria-live="polite"></div>
            </form>
          </div>
        </div>

        <p class="auth-note">ุจุง ูุฑูุฏ ุง ุซุจุชโูุงูุ ุดูุง ุจุง ุดุฑุงุท ู ููุงูู OMID ููุงููุช ูโฺฉูุฏ.</p>
      </div>
    </main>
  </div>

  <!-- ููุฏุงู ุจุงุฒุงุจ ุฑูุฒ -->
  <div id="reset-modal" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="reset-title">
    <div class="modal-content">
      <h3 id="reset-title">ุจุงุฒุงุจ ุฑูุฒ ุนุจูุฑ</h3>
      <p>ุงูู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ ุชุง ููฺฉ ุจุงุฒุงุจ ุจุฑุง ุดูุง ุงุฑุณุงู ุดูุฏ.</p>
      <form id="reset-form" novalidate>
        <input type="email" name="email" placeholder="you@example.com" required />
        <div class="modal-actions">
          <button type="button" class="btn outline" id="close-reset">ุงูุตุฑุงู</button>
          <button type="submit" class="btn primary">ุงุฑุณุงู ููฺฉ</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ุงุณฺฉุฑูพุชโูุง -->
  <script>
    // ุชู ุฐุฎุฑูโุดุฏู
    const applyTheme = (t) => {
      document.documentElement.setAttribute('data-theme', t);
      localStorage.setItem('theme', t);
    };
    applyTheme(localStorage.getItem('theme') || 'light');

    // ุณูุฆฺ ุชู
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle?.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      applyTheme(current === 'light' ? 'dark' : 'light');
    });

    // ุณูุฆฺ ุชุจโูุง
    const tabs = document.querySelectorAll('.auth-tab');
    const forms = document.querySelectorAll('.auth-form');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        const target = document.querySelector(tab.dataset.target);
        forms.forEach(f => f.classList.remove('active'));
        target?.classList.add('active');
      });
    });

    // ููุงุด/ูุฎู ฺฉุฑุฏู ุฑูุฒ
    document.querySelectorAll('.toggle-password').forEach(btn => {
      btn.addEventListener('click', () => {
        const input = btn.previousElementSibling;
        if (!input) return;
        input.type = input.type === 'password' ? 'text' : 'password';
        btn.textContent = input.type === 'password' ? '๐' : '๐โ๐จ';
      });
    });

    // ูุฏุฑุช ุฑูุฒ (ุซุจุชโูุงู)
    const pwd = document.getElementById('signup-password');
    const bar = document.querySelector('.password-strength .bar');
    const strength = (val) => {
      let s = 0;
      if (val.length >= 8) s++;
      if (/[A-Za-z]/.test(val)) s++;
      if (/[0-9]/.test(val)) s++;
      if (/[^A-Za-z0-9]/.test(val)) s++;
      return s; // 0..4
    };
    pwd?.addEventListener('input', (e) => {
      const val = e.target.value;
      const score = strength(val);
      const width = (score / 4) * 100;
      bar.style.width = width + '%';
      bar.dataset.score = String(score);
    });

    // ุงุนุชุจุงุฑุณูุฌ ูพุงู
    const setError = (input, message) => {
      const err = input.parentElement.querySelector('.field-error');
      if (err) err.textContent = message || '';
      input.classList.toggle('invalid', !!message);
    };

    const emailValid = (email) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);

    document.getElementById('login')?.addEventListener('submit', (e) => {
      e.preventDefault();
      const form = e.target;
      const email = form.email;
      const password = form.password;
      let ok = true;

      if (!emailValid(email.value)) {
        setError(email, 'ุงูู ูุนุชุจุฑ ูุณุช');
        ok = false;
      } else setError(email, '');

      if (!password.value) {
        setError(password, 'ุฑูุฒ ุนุจูุฑ ุงูุฒุงู ุงุณุช');
        ok = false;
      } else setError(password, '');

      const msg = form.querySelector('.form-message');
      if (ok) {
        msg.textContent = 'ูุฑูุฏ ุจุง ููููุช ุงูุฌุงู ุดุฏ. ุฏุฑ ุญุงู ุงูุชูุงู...';
        msg.classList.add('success');
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 900);
      } else {
        msg.textContent = 'ูุทูุง ุฎุทุงูุง ูุฑู ุฑุง ุจุฑุทุฑู ฺฉูุฏ.';
        msg.classList.remove('success');
      }
    });

    document.getElementById('signup')?.addEventListener('submit', (e) => {
      e.preventDefault();
      const form = e.target;
      const name = form.name;
      const email = form.email;
      const phone = form.phone;
      const password = form.password;
      const confirm = form.confirm;
      const terms = form.terms;
      let ok = true;

      if (!name.value.trim()) { setError(name, 'ูุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ'); ok = false; } else setError(name, '');
      if (!emailValid(email.value)) { setError(email, 'ุงูู ูุนุชุจุฑ ูุณุช'); ok = false; } else setError(email, '');
      if (phone.value && !/^09\d{9}$/.test(phone.value)) { setError(phone, 'ุดูุงุฑู ููุจุงู ูุนุชุจุฑ ูุณุช'); ok = false; } else setError(phone, '');
      if (password.value.length < 8 || !(/[A-Za-z]/.test(password.value) && /[0-9]/.test(password.value))) {
        setError(password, 'ุฑูุฒ ุจุงุฏ ุญุฏุงูู ธ ฺฉุงุฑุงฺฉุชุฑ ู ุดุงูู ุญุฑู ู ุนุฏุฏ ุจุงุดุฏ');
        ok = false;
      } else setError(password, '');
      if (confirm.value !== password.value) { setError(confirm, 'ุชฺฉุฑุงุฑ ุฑูุฒ ูุทุงุจูุช ูุฏุงุฑุฏ'); ok = false; } else setError(confirm, '');
      if (!terms.checked) ok = false;

      const msg = form.querySelector('.form-message');
      if (ok) {
        msg.textContent = 'ุซุจุชโูุงู ุงูุฌุงู ุดุฏ! ุงฺฉููู ูโุชูุงูุฏ ูุงุฑุฏ ุดูุฏ.';
        msg.classList.add('success');
        // ุณูฺ ุฎูุฏฺฉุงุฑ ุจู ุชุจ ูุฑูุฏ
        document.querySelector('.auth-tab[data-target="#login"]').click();
      } else {
        msg.textContent = 'ูุทูุง ุฎุทุงูุง ูุฑู ุฑุง ุจุฑุทุฑู ฺฉูุฏ.';
        msg.classList.remove('success');
      }
    });

    // ููุฏุงู ูุฑุงููุด ุฑูุฒ
    const modal = document.getElementById('reset-modal');
    const forgot = document.getElementById('forgot-link');
    const closeReset = document.getElementById('close-reset');
    forgot?.addEventListener('click', (e) => {
      e.preventDefault();
      modal.classList.add('open');
      modal.setAttribute('aria-hidden', 'false');
    });
    closeReset?.addEventListener('click', () => {
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden', 'true');
    });
    document.getElementById('reset-form')?.addEventListener('submit', (e) => {
      e.preventDefault();
      modal.classList.remove('open');
      alert('ุงฺฏุฑ ุงูู ุดูุง ุซุจุช ุดุฏู ุจุงุดุฏุ ููฺฉ ุจุงุฒุงุจ ุงุฑุณุงู ูโุดูุฏ.');
    });
  </script>
</body>
</html>